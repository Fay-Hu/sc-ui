"use strict";Component({properties:{ripple:{type:Boolean,value:!0},tabList:{type:Array},tabIndex:{type:Number,value:0}},data:{currentTab:0,touchMoveStartX:0,touchMoveEndX:0,btnMinWidth:88,scrollLeft:0,scroll:0,scrollViewWidth:0,moveLength:64},relations:{"../scTab/sc-tab":{type:"child"}},ready:function(){var t=this;this._queryMultipleNodes(".tab-bar").then(function(a){t.data.scrollViewWidth=a[0].width}),this.data.tabs=this._getAllTab(),this._setTab(this.properties.tabIndex)},methods:{_queryMultipleNodes:function(t){var a=this;return new Promise(function(e,i){var s=a.createSelectorQuery();s.select(t).boundingClientRect(),s.selectViewport().scrollOffset(),s.exec(function(t){e(t)})})},_tabBarTap:function(t){var a=t.target.dataset.idx;this.data.currentTab!==a&&this._setTab(a)},_setTab:function(t){this.setData({currentTab:t}),this.data.scrollViewWidth>=this.data.tabList.length*this.data.btnMinWidth||this._setScroll(t),this._setHeight(t),this.triggerEvent("tabchange",{value:t,data:this.data.tabList[t].data||{}})},_setScroll:function(t){var a=t*this.data.btnMinWidth,e=(t+1)*this.data.btnMinWidth,i=this.data.scrollLeft,s=this.data.scrollViewWidth;a>=i&&e<=Math.ceil(i+s)||(a<=i?0===t?this.setData({scrollLeft:0}):this.setData({scrollLeft:a-(t>0?44:0)}):this.setData({scrollLeft:i+e-(i+s)+(t+1<this.data.tabList.length?44:0)}))},_setHeight:function(t){var a=this.data.tabs;setTimeout(function(){for(var e=0;e<a.length;e++)e===t?a[e].setData({tabHeight:"auto"}):a[e].setData({tabHeight:0})},150)},_touchmove:function(t){this.data.touchMoveStartX?this.data.touchMoveEndX=t.touches[0].clientX:this.data.touchMoveStartX=t.touches[0].clientX},_touchend:function(t){var a=this.data.touchMoveEndX-this.data.touchMoveStartX,e=this.data.currentTab,i=this.data.moveLength;this.setData({touchMoveEndX:null,touchMoveStartX:null}),Math.abs(a)>i&&(a>=0?this.setData({currentTab:e-1>=0?e-1:0}):this.setData({currentTab:e+1<this.properties.tabList.length?e+1:e}),e!==this.data.currentTab&&(this.data.scrollViewWidth>=this.data.tabList.length*this.data.btnMinWidth||this._setScroll(this.data.currentTab),this._setHeight(this.data.currentTab),this.triggerEvent("tabchange",{value:this.data.currentTab,data:this.data.tabList[this.data.currentTab].data||{}})))},_scroll:function(t){this.data.scrollLeft=t.detail.scrollLeft},_getAllTab:function(){return this.getRelationNodes("../scTab/sc-tab")}}});