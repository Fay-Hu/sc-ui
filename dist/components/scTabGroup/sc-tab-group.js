"use strict";Component({properties:{ripple:{type:Boolean,value:!0},tabList:{type:Array},tabIndex:{type:Number,value:0}},data:{currentTab:0,touchMoveStartX:0,touchMoveEndX:0,btnMinWidth:88,scrollLeft:0,scroll:0,scrollViewWidth:0,moveLength:64},relations:{"../scTab/sc-tab":{type:"child"}},ready:function(){var t=this;this._queryMultipleNodes(".tab-bar").then(function(e){t.data.scrollViewWidth=e[0].width}),this.data.tabs=this._getAllTab(),this._setTab(this.properties.tabIndex)},methods:{_queryMultipleNodes:function(t){var e=this;return new Promise(function(a,i){var s=e.createSelectorQuery();s.select(t).boundingClientRect(),s.selectViewport().scrollOffset(),s.exec(function(t){a(t)})})},_tabBarTap:function(t){var e=t.target.dataset.idx;this.data.currentTab!==e&&this._setTab(e)},_setTab:function(t){var e=this.data,a=e.scrollViewWidth,i=e.btnMinWidth;this.setData({currentTab:t}),a>=this.data.tabList.length*i||this._setScroll(t),this._setHeight(t),this.triggerEvent("tabchange",{value:t,data:this.data.tabList[t].data||{}})},_setScroll:function(t){var e=this.data,a=e.scrollLeft,i=e.scrollViewWidth,s=e.btnMinWidth,r=t*s,h=(t+1)*s;r>=a&&h<=Math.ceil(a+i)||(r<=a?this.setData({scrollLeft:0===t?0:r-(t>0?s/2:0)}):this.setData({scrollLeft:a+h-(a+i)+(t+1<this.data.tabList.length?s/2:0)}))},_setHeight:function(t){var e=this.data.tabs;setTimeout(function(){for(var a=0;a<e.length;a++)a===t?e[a].setData({tabHeight:"auto"}):e[a].setData({tabHeight:0})},150)},_touchStart:function(t){this.setData({touchMoveStartX:t.touches[0].clientX})},_touchEnd:function(t){if(1===t.changedTouches.length){var e=this.data,a=e.currentTab,i=e.moveLength,s=e.scrollViewWidth,r=e.btnMinWidth,h=this.properties.tabList.length,n=t.changedTouches[0].clientX-this.data.touchMoveStartX;if(this.setData({touchMoveEndX:0}),Math.abs(n)>i){n>=0?this.setData({currentTab:a-1>=0?a-1:0}):this.setData({currentTab:a+1<h?a+1:a});var o=this.data.currentTab;a!==o&&(s>=h*r||this._setScroll(o),this._setHeight(o),this.triggerEvent("tabchange",{value:o,data:this.data.tabList[o].data||{}}))}}},_scroll:function(t){this.data.scrollLeft=t.detail.scrollLeft},_getAllTab:function(){return this.getRelationNodes("../scTab/sc-tab")}}});