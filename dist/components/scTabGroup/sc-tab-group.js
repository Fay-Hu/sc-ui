"use strict";Component({properties:{ripple:{type:Boolean,value:!0},tabList:{type:Array},tabIndex:{type:Number,value:0}},data:{currentTab:0,touchMoveStartX:0,touchMoveEndX:0,btnMinWidth:88,scrollLeft:0,scroll:0,scrollViewWidth:0,moveLength:64},relations:{"../scTab/sc-tab":{type:"child"}},ready:function(){var t=this;this._queryMultipleNodes(".tab-bar").then(function(e){t.data.scrollViewWidth=e[0].width}),this.data.tabs=this._getAllTab(),this._setTab(this.properties.tabIndex)},methods:{_queryMultipleNodes:function(t){var e=this;return new Promise(function(a,i){var s=e.createSelectorQuery();s.select(t).boundingClientRect(),s.selectViewport().scrollOffset(),s.exec(function(t){a(t)})})},_tabBarTap:function(t){var e=t.target.dataset.idx;this.data.currentTab!==e&&this._setTab(e)},_setTab:function(t){var e=this.data,a=e.scrollViewWidth,i=e.btnMinWidth;this.setData({currentTab:t}),a>=this.data.tabList.length*i||this._setScroll(t),this._setHeight(t),this.triggerEvent("tabchange",{value:t,data:this.data.tabList[t].data||{}})},_setScroll:function(t){var e=this.data,a=e.scrollLeft,i=e.scrollViewWidth,s=e.btnMinWidth,r=t*s,h=(t+1)*s;r>=a&&h<=Math.ceil(a+i)||(r<=a?this.setData({scrollLeft:0===t?0:r-(t>0?s/2:0)}):this.setData({scrollLeft:a+h-(a+i)+(t+1<this.data.tabList.length?s/2:0)}))},_setHeight:function(t){var e=this.data.tabs;setTimeout(function(){for(var a=0;a<e.length;a++)a===t?e[a].setData({tabHeight:"auto"}):e[a].setData({tabHeight:0})},150)},_touchmove:function(t){this.data.touchMoveStartX?this.setData({touchMoveEndX:t.touches[0].clientX}):this.setData({touchMoveStartX:t.touches[0].clientX})},_touchend:function(t){var e=this.data,a=e.touchMoveStartX,i=e.touchMoveEndX,s=e.currentTab,r=e.moveLength,h=e.scrollViewWidth,o=e.btnMinWidth,n=this.properties.tabList.length,c=i-a;if(this.setData({touchMoveEndX:0,touchMoveStartX:0}),Math.abs(c)>r){c>=0?this.setData({currentTab:s-1>=0?s-1:0}):this.setData({currentTab:s+1<n?s+1:s});var l=this.data.currentTab;s!==l&&(h>=n*o||this._setScroll(l),this._setHeight(l),this.triggerEvent("tabchange",{value:l,data:this.data.tabList[l].data||{}}))}},_scroll:function(t){this.data.scrollLeft=t.detail.scrollLeft},_getAllTab:function(){return this.getRelationNodes("../scTab/sc-tab")}}});